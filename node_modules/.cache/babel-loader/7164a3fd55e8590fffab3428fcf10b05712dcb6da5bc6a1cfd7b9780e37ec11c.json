{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nconst BASE_URL = \"/api/steam\";\n\n/**\n * アプリ一覧を取得し、逆順に並べ替えます。\n * @returns {Promise<Array>} アプリ一覧（IDと名前）\n */\nexport async function getAppListReversed() {\n  const url = `${BASE_URL}/ISteamApps/GetAppList/v2`;\n  try {\n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(`HTTPエラー: ${response.status}`);\n    }\n    const data = await response.json();\n\n    // アプリ一覧を逆順に並べ替え\n    return data.applist.apps.reverse();\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * 特定のアプリの詳細情報を取得します。\n * @param   {number} appid アプリID\n * @returns {Promise<Object>} アプリの詳細情報\n */\nexport async function getAppDetails(appid) {\n  const url = `/api/store/api/appdetails?appids=${appid}`;\n  try {\n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(`HTTPエラー: ${response.status}`);\n    }\n    const data = await response.json();\n\n    // レスポンスが空の場合の処理\n    if (!data || !data[appid] || !data[appid].data) {\n      throw new Error(`アプリID ${appid} のデータが存在しません`);\n    }\n    const game = data[appid].data;\n    return {\n      appid: game.steam_appid,\n      name: game.name,\n      header_image: game.header_image,\n      library_image: `https://cdn.cloudflare.steamstatic.com/steam/apps/${appid}/library_600x900.jpg`,\n      genres: game.genres ? game.genres.map(g => g.description) : [],\n      steamAppURL: `https://store.steampowered.com/app/${appid}/`,\n      short_description: game.short_description || \"説明がありません\"\n    };\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * アプリ名で検索をかけ、候補を出力します。\n * @param {string} query 検索クエリ（アプリ名）\n * @returns {Promise<Array>} 検索結果（候補のアプリ一覧）\n */\n\nlet cachedAppList = null;\nexport async function searchAppByName(query) {\n  try {\n    const excludeWord = /\\b(Demo|体験版|DLC|Add[- ]?on|Expansion|Soundtrack|OST|Original Soundtrack|Prologue|Tool|Editor|SDK|Server|Visual Novel|Video|Movie|Bundle|Test|Benchmark|Mod|Manual)\\b/i;\n    if (!cachedAppList) {\n      const appList = await getAppListReversed();\n      cachedAppList = appList.filter(app => !excludeWord.test(app.name));\n    }\n    return cachedAppList.filter(app => app.name.toLowerCase().includes(query.toLowerCase()));\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * アプリ一覧から情報を取得し、postData形式に変換\n * @param {Array<number>} appIds アプリIDの配列\n * @returns {Promise<Array>} postData形式のデータ\n */\nexport async function fetchPostDataReversed(appIds) {\n  try {\n    const postData = await Promise.all(appIds.map(async appid => {\n      try {\n        const game = await getAppDetails(appid);\n        return {\n          appId: game.appid,\n          appName: game.name,\n          appImages: [game.header_image, game.library_image],\n          tags: game.genres,\n          oneWard: game.short_description,\n          steamAppURL: game.steamAppURL\n        };\n      } catch (error) {\n        console.error(`アプリID ${appid} のデータ取得中にエラーが発生しました:`, error);\n        return null;\n      }\n    }));\n    return postData.filter(Boolean);\n  } catch (error) {\n    console.error(\"postData形式への変換中にエラーが発生しました:\", error);\n    throw error;\n  }\n}","map":{"version":3,"names":["BASE_URL","getAppListReversed","url","response","fetch","ok","Error","status","data","json","applist","apps","reverse","error","getAppDetails","appid","game","steam_appid","name","header_image","library_image","genres","map","g","description","steamAppURL","short_description","cachedAppList","searchAppByName","query","excludeWord","appList","filter","app","test","toLowerCase","includes","fetchPostDataReversed","appIds","postData","Promise","all","appId","appName","appImages","tags","oneWard","console","Boolean"],"sources":["/Users/namako-mac/mysite/game-introduction/src/SteamWebAPI/SteamWebAPI.js"],"sourcesContent":["const BASE_URL = \"/api/steam\";\n\n/**\n * アプリ一覧を取得し、逆順に並べ替えます。\n * @returns {Promise<Array>} アプリ一覧（IDと名前）\n */\nexport async function getAppListReversed() {\n  const url = `${BASE_URL}/ISteamApps/GetAppList/v2`;\n\n  try {\n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(`HTTPエラー: ${response.status}`);\n    }\n    const data = await response.json();\n\n    // アプリ一覧を逆順に並べ替え\n    return data.applist.apps.reverse();\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * 特定のアプリの詳細情報を取得します。\n * @param   {number} appid アプリID\n * @returns {Promise<Object>} アプリの詳細情報\n */\nexport async function getAppDetails(appid) {\n  const url = `/api/store/api/appdetails?appids=${appid}`;\n\n  try {\n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(`HTTPエラー: ${response.status}`);\n    }\n    const data = await response.json();\n\n    // レスポンスが空の場合の処理\n    if (!data || !data[appid] || !data[appid].data) {\n      throw new Error(`アプリID ${appid} のデータが存在しません`);\n    }\n\n    const game = data[appid].data;\n\n    return {\n      appid            : game.steam_appid,\n      name             : game.name,\n      header_image     : game.header_image,\n      library_image    : `https://cdn.cloudflare.steamstatic.com/steam/apps/${appid}/library_600x900.jpg`,\n      genres           : game.genres ? game.genres.map((g) => g.description) : [],\n      steamAppURL      : `https://store.steampowered.com/app/${appid}/`,\n      short_description: game.short_description || \"説明がありません\",\n    };\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * アプリ名で検索をかけ、候補を出力します。\n * @param {string} query 検索クエリ（アプリ名）\n * @returns {Promise<Array>} 検索結果（候補のアプリ一覧）\n */\n\nlet cachedAppList = null;\n\nexport async function searchAppByName(query) {\n  try {\n    const excludeWord = /\\b(Demo|体験版|DLC|Add[- ]?on|Expansion|Soundtrack|OST|Original Soundtrack|Prologue|Tool|Editor|SDK|Server|Visual Novel|Video|Movie|Bundle|Test|Benchmark|Mod|Manual)\\b/i;\n    if (!cachedAppList) {\n      const appList   = await getAppListReversed();\n      cachedAppList   = appList.filter(app => !excludeWord.test(app.name));\n    }\n    return cachedAppList.filter(app =>\n      app.name.toLowerCase().includes(query.toLowerCase())\n    );\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * アプリ一覧から情報を取得し、postData形式に変換\n * @param {Array<number>} appIds アプリIDの配列\n * @returns {Promise<Array>} postData形式のデータ\n */\nexport async function fetchPostDataReversed(appIds) {\n  try {\n    const postData = await Promise.all(\n      appIds.map(async (appid) => {\n        try {\n          const game = await getAppDetails(appid);\n\n          return {\n            appId      : game.appid,\n            appName    : game.name,\n            appImages  : [game.header_image, game.library_image],\n            tags       : game.genres,\n            oneWard    : game.short_description,\n            steamAppURL: game.steamAppURL,\n          };\n        } catch (error) {\n          console.error(`アプリID ${appid} のデータ取得中にエラーが発生しました:`, error);\n          return null;\n        }\n      })\n    );\n\n    return postData.filter(Boolean);\n  } catch (error) {\n    console.error(\"postData形式への変換中にエラーが発生しました:\", error);\n    throw error;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}